% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dkge-bootstrap.R
\name{dkge_bootstrap_analytic}
\alias{dkge_bootstrap_analytic}
\title{Analytic first-order bootstrap in the design space}
\usage{
dkge_bootstrap_analytic(
  fit,
  contrasts,
  B = 1000L,
  scheme = c("poisson", "exp", "bayes"),
  ridge = 0,
  align = TRUE,
  allow_reflection = FALSE,
  seed = NULL,
  transport_cache = NULL,
  mapper = "sinkhorn",
  centroids = NULL,
  sizes = NULL,
  medoid = 1L,
  voxel_operator = NULL,
  perturb_tol = 0.2,
  gap_tol = 1e-06,
  ...
)
}
\arguments{
\item{fit}{A fitted `dkge` object.}

\item{contrasts}{Contrast specification accepted by [dkge_contrast()].}

\item{B}{Number of bootstrap replicates.}

\item{scheme}{Multiplier distribution (`"poisson"`, `"exp"`, or `"bayes"`).}

\item{ridge}{Optional ridge added to the reweighted compressed covariance.}

\item{align}{Logical; when `TRUE` the resampled bases are aligned to the
baseline basis via K-Procrustes before contrasts are evaluated.}

\item{allow_reflection}{Passed to [dkge_procrustes_K()] when aligning bases.}

\item{seed}{Optional random seed for reproducibility.}

\item{transport_cache}{Optional cache from [dkge_prepare_transport()].}

\item{mapper}{Mapper specification used when a cache is not supplied.}

\item{centroids}{Optional centroids overriding those stored on the fit.}

\item{sizes}{Optional list of cluster weights passed to
[dkge_prepare_transport()].}

\item{medoid}{Medoid index used during transport.}

\item{voxel_operator}{Optional matrix mapping medoid values to voxels.}

\item{perturb_tol}{Maximum absolute coefficient tolerated in the eigenvector
perturbation; larger changes trigger a fallback to the full eigensolve.}

\item{gap_tol}{Minimum eigen-gap tolerated (in absolute value) before
triggering a fallback to the full eigensolve.}

\item{...}{Additional arguments forwarded to [dkge_prepare_transport()] when
the transport cache needs to be built.}
}
\value{
Same structure as [dkge_bootstrap_qspace()] with additional metadata
  on the number of fallbacks used.
}
\description{
Uses the stored full eigendecomposition to apply first-order perturbations
for each bootstrap draw. When the perturbation exceeds the validity region,
the method falls back to the exact multiplier bootstrap for that replicate.
}
