% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dkge-bootstrap.R
\name{dkge_bootstrap_qspace}
\alias{dkge_bootstrap_qspace}
\title{Multiplier bootstrap in the design space (q-space)}
\usage{
dkge_bootstrap_qspace(
  fit,
  contrasts,
  B = 1000L,
  scheme = c("poisson", "exp", "bayes"),
  ridge = 0,
  align = TRUE,
  allow_reflection = FALSE,
  seed = NULL,
  transport_cache = NULL,
  mapper = "sinkhorn",
  centroids = NULL,
  sizes = NULL,
  medoid = 1L,
  voxel_operator = NULL,
  ...
)
}
\arguments{
\item{fit}{A fitted `dkge` object.}

\item{contrasts}{Contrast specification accepted by [dkge_contrast()].}

\item{B}{Number of bootstrap replicates.}

\item{scheme}{Multiplier distribution (`"poisson"`, `"exp"`, or `"bayes"`).}

\item{ridge}{Optional ridge added to the reweighted compressed covariance.}

\item{align}{Logical; when `TRUE` the resampled bases are aligned to the
baseline basis via K-Procrustes before contrasts are evaluated.}

\item{allow_reflection}{Passed to [dkge_procrustes_K()] when aligning bases.}

\item{seed}{Optional random seed for reproducibility.}

\item{transport_cache}{Optional cache from [dkge_prepare_transport()].}

\item{mapper}{Mapper specification used when a cache is not supplied.}

\item{centroids}{Optional centroids overriding those stored on the fit.}

\item{sizes}{Optional list of cluster weights passed to
[dkge_prepare_transport()].}

\item{medoid}{Medoid index used during transport.}

\item{voxel_operator}{Optional matrix mapping medoid values to voxels.}

\item{...}{Additional arguments forwarded to [dkge_prepare_transport()] when
the transport cache needs to be built.}
}
\value{
List containing per-contrast bootstrap summaries and the transport
  cache employed during resampling.
}
\description{
Reweights subject contributions with i.i.d. multiplier weights, recomputes
the tiny qxq eigendecomposition, and propagates contrasts to the medoid (and
optionally voxel) space using cached transport operators.
}
