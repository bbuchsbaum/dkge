% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design-kernel.R
\name{design_kernel}
\alias{design_kernel}
\alias{dkge_design_kernel}
\title{Build a flexible design-similarity kernel}
\usage{
design_kernel(
  factors,
  terms = NULL,
  rho = NULL,
  include_intercept = TRUE,
  rho0 = 1e-08,
  basis = c("cell", "effect"),
  contrasts = NULL,
  block_structure = NULL,
  normalize = c("unit_trace", "none", "unit_fro", "max_diag"),
  jitter = 1e-08
)

dkge_design_kernel(
  factors,
  terms = NULL,
  rho = NULL,
  include_intercept = TRUE,
  rho0 = 1e-08,
  basis = c("cell", "effect"),
  contrasts = NULL,
  block_structure = NULL,
  normalize = c("unit_trace", "none", "unit_fro", "max_diag"),
  jitter = 1e-08
)
}
\arguments{
\item{factors}{Named list of factor specifications. Each factor is described
by a list containing:
\describe{
  \item{type}{"nominal" | "ordinal" | "circular" | "continuous" (default "nominal").}
  \item{L}{Number of levels (for discrete types).}
  \item{values}{Numeric coordinates for continuous factors.}
  \item{l}{Optional length-scale for ordinal/circular/continuous factors.}
}}

\item{terms}{List of character vectors describing which factors appear in each
kernel term (e.g. list("A","B", c("A","B"))). Defaults to all main
effects plus the full interaction.}

\item{rho}{Named numeric weights per term (names like "A", "A:B"). Defaults
to 1 for each term if omitted. Must be non-negative.}

\item{include_intercept}{Logical; if TRUE adds a small identity ridge
(controlled by `rho0`) to keep the kernel full rank (default TRUE).}

\item{rho0}{Non-negative scalar ridge weight added when `include_intercept` is
TRUE (default 1e-8).}

\item{basis}{Either "cell" (kernel over all design cells) or "effect" (kernel
over regressors/effects). Default "cell".}

\item{contrasts}{Optional named list of per-factor contrast matrices used when
`basis="effect"`. Defaults to sum-to-zero contrasts for discrete factors and
a single column of ones for continuous factors.}

\item{block_structure}{Optional ordering of effect blocks (names matching
terms). If NULL, uses the order of `terms`.}

\item{normalize}{One of "unit_trace", "none", "unit_fro", "max_diag".
Controls how the kernel is scaled after construction (default "unit_trace").}

\item{jitter}{Small diagonal jitter added to `K_cell` for numerical stability
(default 1e-8).}
}
\value{
A list with elements `K` (kernel in requested basis), `K_cell` (always
  returned), and `info` containing metadata such as factor/term names, mapping
  matrix, and block indices.
}
\description{
Constructs a PSD kernel that captures factorial similarity across design
effects, optionally mapping from cell space to effect space using contrasts.
}
