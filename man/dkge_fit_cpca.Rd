% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dkge-cpca.R
\name{dkge_fit_cpca}
\alias{dkge_fit_cpca}
\title{Fit DKGE bases on CPCA-filtered components}
\usage{
dkge_fit_cpca(
  fit,
  blocks = NULL,
  T = NULL,
  part = c("design", "resid", "both"),
  rank = NULL,
  ridge = 0
)
}
\arguments{
\item{fit}{A `dkge` object from [dkge_fit()] or [dkge()].}

\item{blocks}{Optional integer vector of effect indices defining the subspace
(used when `T` is not supplied).}

\item{T}{Optional explicit q√óq0 basis matrix; overrides `blocks` when given.}

\item{part}{Which portion to return: "design", "resid", or "both".}

\item{rank}{Target rank for the returned bases (defaults to `ncol(fit$U)`).}

\item{ridge}{Optional ridge term applied before the eigen decompositions.}
}
\value{
List containing the requested bases/eigenvalues and the projector.
}
\description{
Computes separate DKGE bases on the CPCA design-aligned or residual parts of
the compressed covariance. Helpful for decomposing the latent space into
interpretable sub-structures.
}
