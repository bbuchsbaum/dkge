% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dkge-render-core.R
\name{dkge_build_renderer}
\alias{dkge_build_renderer}
\title{Prepare reusable rendering objects for a fitted DKGE model}
\usage{
dkge_build_renderer(
  fit,
  centroids,
  anchors = NULL,
  anchor_xyz = NULL,
  anchor_n = 20000L,
  anchor_method = c("kmeans", "sample"),
  anchor_seed = NULL,
  vox_xyz = NULL,
  mapper = dkge_mapper("knn", k = 8, sigx = 3),
  graph_k = NULL,
  decoder_k = 8,
  reliabilities = NULL,
  subject_feats = NULL,
  anchor_feats = NULL,
  feat_lambda = NULL,
  feat_sigma = NULL
)
}
\arguments{
\item{fit}{Fitted `dkge` object.}

\item{centroids}{List of per-subject centroid matrices (`P_s x 3`).
Must align with `fit$Btil`.}

\item{anchors}{Optional precomputed anchor coordinate matrix. When `NULL`,
anchors are derived from `anchor_xyz` if provided, otherwise from
`vox_xyz`.}

\item{anchor_xyz}{Optional matrix of candidate points used to derive anchors
via [dkge_make_anchors()]. Ignored when `anchors` is supplied.}

\item{anchor_n}{Number of anchors to draw when constructing them from
coordinates.}

\item{anchor_method}{Method passed to [dkge_make_anchors()] when anchors are
derived. Defaults to `"kmeans"`.}

\item{anchor_seed}{Optional seed forwarded to [dkge_make_anchors()].}

\item{vox_xyz}{Optional voxel coordinates for constructing a decoder.}

\item{mapper}{Mapper specification created with [dkge_mapper()]. Defaults to
the barycentric kNN mapper.}

\item{graph_k}{Optional integer; when provided, an anchor graph of this
neighbourhood size is constructed for subsequent smoothing.}

\item{decoder_k}{Number of anchors per voxel when building the decoder.}

\item{reliabilities}{Optional list of per-subject reliability vectors passed
to the mapper during fitting.}

\item{subject_feats}{Optional list of matrices supplying latent features per
subject cluster. When provided and the mapper consumes latent information
(e.g., Sinkhorn), they are forwarded via `subj_feats`.}

\item{anchor_feats}{Optional anchor-level feature matrix aligned with
`anchors`. Derived automatically by pooling subject features when `NULL`
and `subject_feats` are provided.}

\item{feat_lambda}{Feature cost weight passed to Sinkhorn mappers. Ignored by
kNN.}

\item{feat_sigma}{Feature bandwidth used when computing feature costs.}
}
\value{
A list bundling anchors, optional graph/decoder, fitted per-subject
  mappers, and subject weights.
}
\description{
Prepare reusable rendering objects for a fitted DKGE model
}
